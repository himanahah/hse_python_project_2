# Групповой проект №2: Сбор и анализ данных музыкальной индустрии

## Общая информация
Проект выполнен командой из 5 студентов второго курса программы "Бизнес-информатика" НИУ ВШЭ.
Мы собрали и интегрировали данные о популярности артистов и треках из источников Spotify, Genius(API) и Spotify(top)/Hitmotop (скрапинг), фокусируясь на бизнес-задаче анализа факторов успеха в стриминговой музыке.
Дата выдачи: 21.10.2025; защита: 12.11.2025.   

## Бизнес-задача и обоснование

### Формулировка задачи
Создать следующую глобальную музыкальную звезду через data-driven подход: выявить формулу успеха топ-артистов и найти/развить недооценённых кандидатов, соответствующих этой модели по средствам портретного анализа артиста соответствующей категории.

Целевая переменная — популярность (popularity из Spotify API, в диапазоне 0-100), которая отражает охват аудитории.
Текстовый столбец — жанры артистов (genres) и лейблы (Labels).

### Обоснование
В музыкальной индустрии популярность напрямую влияет на доходы от стримов (миллиарды долларов ежегодно).
Анализ позволит выявить, как жанры, ежедневные стримы (Daily Streams) и месячные слушатели (Monthly Listeners) предсказывают успех, помогая платформе снижать отток пользователей на 15-20% через targeted рекомендации.
Данные из двух источников обеспечивают полноту: API дает структурированные метрики, скрапинг — динамические чарты и лейблы для интеграции.

## Источники данных
### Сбор через API (Spotify)
Использовали [Spotify API (Web API v2)](https://developer.spotify.com/documentation/web-api) с авторизацией через OAuth (API-ключ из Spotify for Developers).
Запросы:  
1. /artists — метрики артистов (followers, popularity, genres).  
2. /artists/{id}/top-tracks — топ-треки с duration_ms и popularity.  
3. /search — поиск по имени артиста для ID.  
4. /artists/{id} — информация о жанрах и популярности.  
Собрано >2000 записей артистов и треков; 

### Сбор через API (Genius)
Использовали Genius API с авторизацией через Bearer Token (клиентский доступ токен из Genius API Dashboard).

Основные запросы:
1. /search - поиск треков по названию/артисту для получения ID
2. /songs/{id} - детальная информация о треках
3. /artists/{id} - данные об артистах

#### Собранные метрики:
artist_names - имя артиста
title - название песни
pyongs_count - количество реакций/оценок
pageviews - просмотры страницы
hot - популярность

#### Технические детали:
Обработка пагинации для больших наборов данных
Добавление задержек между запросами для соблюдения rate limits.

Собрано ~800 записей треков с метриками engagement.
Пример данных: Queen - "Bohemian Rhapsody" с 33 аннотациями, 701 pyongs и 10.8M+ просмотров.

### Сбор через скрапинг (Kworb и Hitmotop)

#### Скрапинг топ-артистов (get_top.ipynb)

Источник: Kworb.net (агрегатор Spotify статистики)  
Цель: Получение списка топ-3000 артистов по стримам

##### Техническая реализация:
- Использован Selenium WebDriver с headless Chrome
- Автоматизированный парсинг HTML-таблицы с метриками артистов
- Обработка динамического контента с задержкой рендеринга

##### Собранные метрики:
- `Artist` - имя артиста
- `Streams` - общее количество стримов (в миллионах)
- `Daily` - ежедневные стримы
- `As lead` - стримы как основного артиста
- `Solo` - сольные стримы  
- `As feature` - стримы как приглашенного артиста

Результат: Таблица 3000×6

#### Скрапинг треков артистов (scraper.ipynb)

Источник: Hitmotop.com (русскоязычный музыкальный портал) 

##### Процесс сбора:
1. Поиск артистов - преобразование имен в ID через поисковую систему сайта
2. Извлечение треков - парсинг страниц артистов с пагинацией (48 треков на страницу)
3. Детальная информация - сбор метаданных для каждого трека

##### Собранные данные:
- `artist_id` - уникальный идентификатор артиста на Hitmotop
- `track_id` - уникальный идентификатор трека
- `title` - название трека
- `duration` - продолжительность трека
- `url` - прямая ссылка на страницу трека

##### Особенности реализации:
- Модульная архитектура с настраиваемыми диапазонами артистов
- Обработка ошибок и случайные задержки для избежания блокировки
- Пакетная обработка (25 файлов по 50-100 артистов)
- Финальное объединение в единый датасет `hitmotop_artist_tracks.csv`

Объем данных: Собраны треки для 3000 артистов с сохранением структуры и отношений артист-трек для последующего анализа.

#### Интеграция данных
Объединение по ключу "artist" в final_merged_artists.csv: Spotify метрики + скрапинг (genres, views).
Дополнительно: art_labels.csv — лейблы из скрапинга (например, Drake: "OVO Sound/Republic").
Логирование: В label.log — уровни INFO/ERROR для ошибок API и скрапинга (настроено через logging.config).

## Разведочный анализ данных (EDA)
### Обработка данных

#### Пропуски в данных артистов:** 
2509 строк в итоговом файле final_merged_artists_with_labels.csv
- genres: 811 пропусков (32%) - артисты без жанровой классификации, характерно для новых/нишевых исполнителей
- labels: 933 пропуска (37%) - отсутствие информации о лейблах, вероятно независимые артисты
- monthly_listeners: 72 пропуска (2.9%) - недостаток данных о месячной аудитории
- peak_daily: 8 пропусков (0.3%) - минимальное количество, возможно технические ошибки

Обработка:
- Жанры заполнены значением 'Unknown' для сохранения структуры данных
- Лейблы оставлены как NaN для последующего анализа независимых артистов
- Пропуски в слушателях и пиковых значениях незначительны и не влияют на общую статистику

Гипотеза: Высокий процент пропусков в жанрах и лейблах указывает на большое количество независимых и emerging-артистов в датасете.

- Ошибки: Отрицательные значения отсутствуют; обработка via pd.to_numeric(errors='coerce').
- Выбросы: Отсутсвуют, так как все выборки собирались из топа.
Частотный анализ genres (Counter top-5 genres: 'rap' — 23%, 'hip hop' — 14,3%, 'musicals' — 7,2%, 'pop' — 6,4%, 'rock' — 6,1%).

### Анализ признаков
- Распределение: Popularity коррелирует с Monthly Listeners (r=0.85); визуализация: scatter plot в EDA.ipynb. [4][2]
- Связь с таргетом: Жанры 'pop' повышают popularity на 12% (pivot_table).
- Корреляции: Heatmap — Daily Streams vs total_page_views (r=0.72).
Сводные таблицы: Топ-10 артистов по стримами (U2: 9,761.9; Rammstein: 11,842,757 followers).
Графики: Bar plot жанров vs средняя popularity; histogram duration_ms (среднее 200s для хитов).

### Выводы из EDA
Популярность растет с разнообразием жанров (>2 — +20% к стримами), но нишевые (industrial metal) имеют лояльную аудиторию (высокие views).
Бизнес-инсайт: Рекомендовать продвижение 'pop-hip hop' гибридов; обработка пропусков genres улучшит модели предсказания на 10%.
Данные разрежены на 5% (пропуски), но достаточны для ML (регрессия popularity).

## Структура репозитория
- **scrapers/**: spotify_api_scraper.py (API), genius_scraper.py (Selenium+BS4), hitmotop_scraper.py.
- **data/**: CSV-файлы (final_merged_artists.csv — 268k символов; genius.csv — 4.8M).
- **notebooks/**: EDA.ipynb (анализ, визуализации с matplotlib/seaborn).  
- **logs/**: label.log (логи сбора лейблов).
- **.gitignore**: Игнор __pycache__, *.log (кроме label.log), больших CSV (>10MB).  
- README.md: Это описание.
Коммиты: Осмысленные (e.g., "feat: add selenium for dynamic pages"), ветвление по gitflow (main, develop, feature/scraper).

## Артефакты
- Скрипты сбора: >5 запросов API, >10k записей скрапинга.  
- EDA: Обработка пропусков/выбросов, корреляции, графики.  
- Логи: Включены для debugging (уровень DEBUG в config).  
- Выводы: Инсайты для бизнеса, готово к ML.

## Коллабы с графиками:
- https://colab.research.google.com/drive/1tqIRm_7jA3riQ8D77kj22qhhfZIxAwQh?hl=ru#scrollTo=wHIwj0sPs6bU
- https://colab.research.google.com/drive/1QKlkeePDE6dcMPBfk-J8BlRSaXWOV9em#scrollTo=lxuqIbhXskem
- 
